<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!-- WARNING: Eclipse auto-generated file.
              Any modifications will be overwritten.
              To include a user specific buildfile here, simply create one in the same
              directory with the processing instruction <?eclipse.ant.import?>
              as the first entry and export the buildfile again. --><project basedir="." default="build" name="soot">
    <property environment="env"/>
    <property name="Instrumentor.location" value="../../../../media/joshua/ext4_backup/home/joshua/workspace/Instrumentor"/>
    <property name="TrimDroid.location" value="../../../../media/joshua/ext4_backup/home/joshua/workspace/TrimDroid"/>
    <property name="investigator.location" value="../investigator"/>
    <property name="pathexecutor.location" value="../../../../media/joshua/ext4_backup/home/joshua/workspace/pathexecutor"/>
    <property name="revealdroid.location" value="../revealdroid"/>
    <property name="seal-utils.location" value="../../../../media/joshua/ext4_backup/home/joshua/workspace/seal-utils"/>
    <property name="soot-infoflow.location" value="../soot-infoflow"/>
    <property name="soot-infoflow-android.location" value="../soot-infoflow-android"/>
    <property name="uic_exploit_gen.location" value="../../../../media/joshua/ext4_backup/home/joshua/workspace/uic_exploit_gen"/>
    <property name="ECLIPSE_HOME" value="../../Applications/eclipse-jee-luna/"/>
    <property name="heros.location" value="../heros"/>
    <property name="jasmin.location" value="../jasmin"/>
    <property name="debuglevel" value="source,lines,vars"/>
    <property name="target" value="1.7"/>
    <property name="source" value="1.7"/>
    <path id="jasmin.classpath">
        <pathelement location="${jasmin.location}/classes"/>
        <pathelement location="${jasmin.location}/libs/java_cup.jar"/>
    </path>
    <path id="Plug-in Dependencies.libraryclasspath"/>
    <path id="heros.classpath">
        <path refid="Plug-in Dependencies.libraryclasspath"/>
        <pathelement location="${heros.location}/bin"/>
        <pathelement location="${heros.location}/guava-14.0.1.jar"/>
        <pathelement location="${heros.location}/slf4j-api-1.7.5.jar"/>
        <pathelement location="${heros.location}/junit.jar"/>
        <pathelement location="${heros.location}/org.hamcrest.core_1.3.0.jar"/>
    </path>
    <path id="soot.classpath">
        <pathelement location="classes"/>
        <path refid="jasmin.classpath"/>
        <path refid="heros.classpath"/>
        <pathelement location="libs/polyglot.jar"/>
        <pathelement location="libs/AXMLPrinter2.jar"/>
        <pathelement location="libs/hamcrest-all-1.3.jar"/>
        <pathelement location="libs/junit-4.11.jar"/>
        <pathelement location="libs/dexlib2-2.0.3-dev.jar"/>
        <pathelement location="libs/util-2.0.3-dev.jar"/>
        <pathelement location="libs/asm-debug-all-5.0.3.jar"/>
    </path>
    <target name="init">
        <mkdir dir="classes"/>
        <copy includeemptydirs="false" todir="classes">
            <fileset dir="generated/jastadd">
                <exclude name="**/*.uad"/>
                <exclude name="**/*.ucd"/>
                <exclude name="**/*.uld"/>
                <exclude name="**/*.upd"/>
                <exclude name="**/*.udd"/>
                <exclude name="**/*.uod"/>
                <exclude name="**/*.usd"/>
                <exclude name="**/*.utd"/>
                <exclude name="**/*.uud"/>
                <exclude name="**/*.odd"/>
                <exclude name="**/*.ead"/>
                <exclude name="**/*.ecd"/>
                <exclude name="**/*.eld"/>
                <exclude name="**/*.epd"/>
                <exclude name="**/*.edd"/>
                <exclude name="**/*.eod"/>
                <exclude name="**/*.esd"/>
                <exclude name="**/*.etd"/>
                <exclude name="**/*.eud"/>
                <exclude name="**/*.urd"/>
                <exclude name="**/*.uml"/>
                <exclude name="**/*.ecore"/>
                <exclude name="**/*.java"/>
            </fileset>
        </copy>
        <copy includeemptydirs="false" todir="classes">
            <fileset dir="src">
                <exclude name="**/*.uad"/>
                <exclude name="**/*.ucd"/>
                <exclude name="**/*.uld"/>
                <exclude name="**/*.upd"/>
                <exclude name="**/*.udd"/>
                <exclude name="**/*.uod"/>
                <exclude name="**/*.usd"/>
                <exclude name="**/*.utd"/>
                <exclude name="**/*.uud"/>
                <exclude name="**/*.odd"/>
                <exclude name="**/*.ead"/>
                <exclude name="**/*.ecd"/>
                <exclude name="**/*.eld"/>
                <exclude name="**/*.epd"/>
                <exclude name="**/*.edd"/>
                <exclude name="**/*.eod"/>
                <exclude name="**/*.esd"/>
                <exclude name="**/*.etd"/>
                <exclude name="**/*.eud"/>
                <exclude name="**/*.urd"/>
                <exclude name="**/*.uml"/>
                <exclude name="**/*.ecore"/>
                <exclude name="**/*.java"/>
                <exclude name="soot/jimple/toolkits/ctl/CTLEvaluator.java"/>
                <exclude name="soot/jimple/toolkits/ctl/CopyOfCTLAnalysis.java"/>
                <exclude name="soot/jimple/toolkits/ctl/formula/AF.java"/>
                <exclude name="soot/jimple/toolkits/ctl/formula/AG.java"/>
                <exclude name="soot/jimple/toolkits/ctl/formula/AU.java"/>
                <exclude name="soot/jimple/toolkits/ctl/formula/AX.java"/>
                <exclude name="soot/jimple/toolkits/ctl/formula/EF.java"/>
                <exclude name="soot/jimple/toolkits/ctl/formula/And.java"/>
            </fileset>
        </copy>
        <copy includeemptydirs="false" todir="classes">
            <fileset dir="tests">
                <exclude name="**/*.uad"/>
                <exclude name="**/*.ucd"/>
                <exclude name="**/*.uld"/>
                <exclude name="**/*.upd"/>
                <exclude name="**/*.udd"/>
                <exclude name="**/*.uod"/>
                <exclude name="**/*.usd"/>
                <exclude name="**/*.utd"/>
                <exclude name="**/*.uud"/>
                <exclude name="**/*.odd"/>
                <exclude name="**/*.ead"/>
                <exclude name="**/*.ecd"/>
                <exclude name="**/*.eld"/>
                <exclude name="**/*.epd"/>
                <exclude name="**/*.edd"/>
                <exclude name="**/*.eod"/>
                <exclude name="**/*.esd"/>
                <exclude name="**/*.etd"/>
                <exclude name="**/*.eud"/>
                <exclude name="**/*.urd"/>
                <exclude name="**/*.uml"/>
                <exclude name="**/*.ecore"/>
                <exclude name="**/*.java"/>
            </fileset>
        </copy>
        <copy includeemptydirs="false" todir="classes">
            <fileset dir="generated/options">
                <exclude name="**/*.uad"/>
                <exclude name="**/*.ucd"/>
                <exclude name="**/*.uld"/>
                <exclude name="**/*.upd"/>
                <exclude name="**/*.udd"/>
                <exclude name="**/*.uod"/>
                <exclude name="**/*.usd"/>
                <exclude name="**/*.utd"/>
                <exclude name="**/*.uud"/>
                <exclude name="**/*.odd"/>
                <exclude name="**/*.ead"/>
                <exclude name="**/*.ecd"/>
                <exclude name="**/*.eld"/>
                <exclude name="**/*.epd"/>
                <exclude name="**/*.edd"/>
                <exclude name="**/*.eod"/>
                <exclude name="**/*.esd"/>
                <exclude name="**/*.etd"/>
                <exclude name="**/*.eud"/>
                <exclude name="**/*.urd"/>
                <exclude name="**/*.uml"/>
                <exclude name="**/*.ecore"/>
                <exclude name="**/*.java"/>
                <exclude name="soot/AntTask.java"/>
            </fileset>
        </copy>
        <copy includeemptydirs="false" todir="classes">
            <fileset dir="generated/sablecc">
                <exclude name="**/*.uad"/>
                <exclude name="**/*.ucd"/>
                <exclude name="**/*.uld"/>
                <exclude name="**/*.upd"/>
                <exclude name="**/*.udd"/>
                <exclude name="**/*.uod"/>
                <exclude name="**/*.usd"/>
                <exclude name="**/*.utd"/>
                <exclude name="**/*.uud"/>
                <exclude name="**/*.odd"/>
                <exclude name="**/*.ead"/>
                <exclude name="**/*.ecd"/>
                <exclude name="**/*.eld"/>
                <exclude name="**/*.epd"/>
                <exclude name="**/*.edd"/>
                <exclude name="**/*.eod"/>
                <exclude name="**/*.esd"/>
                <exclude name="**/*.etd"/>
                <exclude name="**/*.eud"/>
                <exclude name="**/*.urd"/>
                <exclude name="**/*.uml"/>
                <exclude name="**/*.ecore"/>
                <exclude name="**/*.java"/>
            </fileset>
        </copy>
        <copy includeemptydirs="false" todir="classes">
            <fileset dir="generated/singletons">
                <exclude name="**/*.uad"/>
                <exclude name="**/*.ucd"/>
                <exclude name="**/*.uld"/>
                <exclude name="**/*.upd"/>
                <exclude name="**/*.udd"/>
                <exclude name="**/*.uod"/>
                <exclude name="**/*.usd"/>
                <exclude name="**/*.utd"/>
                <exclude name="**/*.uud"/>
                <exclude name="**/*.odd"/>
                <exclude name="**/*.ead"/>
                <exclude name="**/*.ecd"/>
                <exclude name="**/*.eld"/>
                <exclude name="**/*.epd"/>
                <exclude name="**/*.edd"/>
                <exclude name="**/*.eod"/>
                <exclude name="**/*.esd"/>
                <exclude name="**/*.etd"/>
                <exclude name="**/*.eud"/>
                <exclude name="**/*.urd"/>
                <exclude name="**/*.uml"/>
                <exclude name="**/*.ecore"/>
                <exclude name="**/*.java"/>
            </fileset>
        </copy>
    </target>
    <target name="clean">
        <delete dir="classes"/>
    </target>
    <target depends="clean" name="cleanall">
        <ant antfile="build.xml" dir="${heros.location}" inheritAll="false" target="clean"/>
        <ant antfile="build.xml" dir="${jasmin.location}" inheritAll="false" target="clean"/>
    </target>
    <target depends="build-subprojects,build-project" name="build"/>
    <target name="build-subprojects">
        <ant antfile="build.xml" dir="${heros.location}" inheritAll="false" target="build-project">
            <propertyset>
                <propertyref name="build.compiler"/>
            </propertyset>
        </ant>
        <ant antfile="build.xml" dir="${jasmin.location}" inheritAll="false" target="build-project">
            <propertyset>
                <propertyref name="build.compiler"/>
            </propertyset>
        </ant>
    </target>
    <target depends="init" name="build-project">
        <echo message="${ant.project.name}: ${ant.file}"/>
        <javac debug="true" debuglevel="${debuglevel}" destdir="classes" includeantruntime="false" source="${source}" target="${target}">
            <src path="generated/jastadd"/>
            <src path="src"/>
            <src path="tests"/>
            <src path="generated/options"/>
            <src path="generated/sablecc"/>
            <src path="generated/singletons"/>
            <exclude name="soot/jimple/toolkits/ctl/CTLEvaluator.java"/>
            <exclude name="soot/jimple/toolkits/ctl/CopyOfCTLAnalysis.java"/>
            <exclude name="soot/jimple/toolkits/ctl/formula/AF.java"/>
            <exclude name="soot/jimple/toolkits/ctl/formula/AG.java"/>
            <exclude name="soot/jimple/toolkits/ctl/formula/AU.java"/>
            <exclude name="soot/jimple/toolkits/ctl/formula/AX.java"/>
            <exclude name="soot/jimple/toolkits/ctl/formula/EF.java"/>
            <exclude name="soot/jimple/toolkits/ctl/formula/And.java"/>
            <exclude name="soot/AntTask.java"/>
            <classpath refid="soot.classpath"/>
        </javac>
        <copy file="src/soot/jbco/gui/jbco.jpg" tofile="classes/soot/jbco/gui/jbco.jpg"/>
    </target>
    <target description="Build all projects which reference this project. Useful to propagate changes." name="build-refprojects">
        <ant antfile="build.xml" dir="${Instrumentor.location}" inheritAll="false" target="clean"/>
        <ant antfile="build.xml" dir="${Instrumentor.location}" inheritAll="false" target="build">
            <propertyset>
                <propertyref name="build.compiler"/>
            </propertyset>
        </ant>
        <ant antfile="build.xml" dir="${TrimDroid.location}" inheritAll="false" target="clean"/>
        <ant antfile="build.xml" dir="${TrimDroid.location}" inheritAll="false" target="build">
            <propertyset>
                <propertyref name="build.compiler"/>
            </propertyset>
        </ant>
        <ant antfile="build.xml" dir="${investigator.location}" inheritAll="false" target="clean"/>
        <ant antfile="build.xml" dir="${investigator.location}" inheritAll="false" target="build">
            <propertyset>
                <propertyref name="build.compiler"/>
            </propertyset>
        </ant>
        <ant antfile="build.xml" dir="${pathexecutor.location}" inheritAll="false" target="clean"/>
        <ant antfile="build.xml" dir="${pathexecutor.location}" inheritAll="false" target="build">
            <propertyset>
                <propertyref name="build.compiler"/>
            </propertyset>
        </ant>
        <ant antfile="build.xml" dir="${revealdroid.location}" inheritAll="false" target="clean"/>
        <ant antfile="build.xml" dir="${revealdroid.location}" inheritAll="false" target="build">
            <propertyset>
                <propertyref name="build.compiler"/>
            </propertyset>
        </ant>
        <ant antfile="build.xml" dir="${seal-utils.location}" inheritAll="false" target="clean"/>
        <ant antfile="build.xml" dir="${seal-utils.location}" inheritAll="false" target="build">
            <propertyset>
                <propertyref name="build.compiler"/>
            </propertyset>
        </ant>
        <ant antfile="build.xml" dir="${soot-infoflow.location}" inheritAll="false" target="clean"/>
        <ant antfile="build.xml" dir="${soot-infoflow.location}" inheritAll="false" target="build">
            <propertyset>
                <propertyref name="build.compiler"/>
            </propertyset>
        </ant>
        <ant antfile="build.xml" dir="${soot-infoflow-android.location}" inheritAll="false" target="clean"/>
        <ant antfile="build.xml" dir="${soot-infoflow-android.location}" inheritAll="false" target="build">
            <propertyset>
                <propertyref name="build.compiler"/>
            </propertyset>
        </ant>
        <ant antfile="build.xml" dir="${uic_exploit_gen.location}" inheritAll="false" target="clean"/>
        <ant antfile="build.xml" dir="${uic_exploit_gen.location}" inheritAll="false" target="build">
            <propertyset>
                <propertyref name="build.compiler"/>
            </propertyset>
        </ant>
    </target>
    <target description="copy Eclipse compiler jars to ant lib directory" name="init-eclipse-compiler">
        <copy todir="${ant.library.dir}">
            <fileset dir="${ECLIPSE_HOME}/plugins" includes="org.eclipse.jdt.core_*.jar"/>
        </copy>
        <unzip dest="${ant.library.dir}">
            <patternset includes="jdtCompilerAdapter.jar"/>
            <fileset dir="${ECLIPSE_HOME}/plugins" includes="org.eclipse.jdt.core_*.jar"/>
        </unzip>
    </target>
    <target description="compile project with Eclipse compiler" name="build-eclipse-compiler">
        <property name="build.compiler" value="org.eclipse.jdt.core.JDTCompilerAdapter"/>
        <antcall target="build"/>
    </target>
    <target name="soot.Main BankAccount.apk">
        <java classname="soot.Main" failonerror="true" fork="yes">
            <arg line="-d /home/joshua/branchcov/bankaccount/out &#10;-android-jars /home/joshua/android-sdks/platforms &#10;-allow-phantom-refs&#10;-src-prec apk &#10;-f j&#10;-w &#10;-process-dir /home/joshua/branchcov/BankAccount.apk"/>
            <classpath refid="soot.classpath"/>
        </java>
    </target>
    <target name="soot.Main TestNullIpcApp3">
        <java classname="soot.Main" failonerror="true" fork="yes">
            <arg line="--keep-line-number --xml-attributes --f J --src-prec java --cp /media/joshua/ext4_backup/home/joshua/workspace/TestNullIpcApp3/bin/classes/:/home/joshua/android-sdks/platforms/android-14/android.jar:/TestNullIpcApp3/src:/TestNullIpcApp3/gen::/media/joshua/ext4_backup/home/joshua/workspace/TestNullIpcApp3/src:/home/joshua/android-sdks/platforms/android-14/android.jar --d /media/joshua/ext4_backup/home/joshua/workspace/TestNullIpcApp3/sootOutput com.example.testnullipcapp3.MainActivity"/>
            <classpath refid="soot.classpath"/>
        </java>
    </target>

    <target name="buildtests" depends="compile,settings">
        <mkdir dir="testclasses"/>
        <javac
            srcdir="tests"
            destdir="testclasses"
            classpath="classes:${polyglot.jar}:${jasmin.jar}:${junit.jar}:${hamcrest.jar}"
            debug="true"
            />
    </target>

    <target name="runtests" depends="buildtests,settings">
	<mkdir dir="reports" />
        <junit printsummary="yes" fork="true">
            <classpath>
                <pathelement location="testclasses"/>
                <pathelement location="classes"/>
                <pathelement location="${polyglot.jar}"/>
                <pathelement location="${jasmin.jar}"/>
                <pathelement location="${junit.jar}"/>
                <pathelement location="${hamcrest.jar}"/>
           	<pathelement location="${dexlib2.jar}"/>
                <pathelement location="${dexlib-utils.jar}"/>
                <pathelement location="${heros.jar}"/>
           		<pathelement location="${asm.jar}"/>
            </classpath>
			
			<jvmarg value="-ea" />
            
            <formatter type="xml" usefile="true" />
            <batchtest todir="reports">
                <fileset dir="testclasses" includes="**/Test*.class"/>
                <fileset dir="testclasses" includes="**/*Test.class"/>
            </batchtest>
        </junit>
    </target>

    <target name="reporttests" depends="runtests">
        <junitreport tofile="TESTS-TestSuites.xml" todir="reports">
            <fileset dir="reports">
                <include name="TEST-*.xml" />
            </fileset>
            <report format="frames" todir="reports" />
        </junitreport>
    </target>

    <target name="release" depends="barebones,javadoc,settings">
    </target>

    <target name="barebones" depends="clean,options,sablecc,settings">
        <tar destfile="${release.loc}/sootsrc-${soot.version}.tar.gz" compression="gzip" longfile="gnu">
            <tarfileset dir="."/>
        </tar>
        <jar destfile="${release.loc}/sootsrc-${soot.version}.jar">
            <fileset dir="."/>
        </jar>
    </target>

    <target name="classesjar" depends="settings,compile">
    	<mkdir dir="META-INF"/>

        <manifest file="META-INF/MANIFEST.MF">
           <attribute name="Main-Class" value="soot.Main"/>
           <attribute name="Implementation-Version" value="${soot.version}"/> 
        </manifest>

    	<jar destfile="${release.loc}/sootclasses-${soot.version}.jar" manifest="META-INF/MANIFEST.MF">
            <fileset dir="classes"/>
        </jar>
		<delete dir="META-INF"/>
    </target>

    <target name="eclipse-plugin" depends="compile,settings,graph-plugin">
        <xslt
            style="src/soot/options/phase_options_dialog.xsl"
            in="src/soot/options/soot_options.xml"
            out="eclipse/ca.mcgill.sable.soot/src/ca/mcgill/sable/soot/ui/PhaseOptionsDialog.java"
        />
        <javac
            destdir="eclipse/ca.mcgill.sable.soot/classes"
            debug="true"
        >
            <src path="eclipse/ca.mcgill.sable.soot/src"/>
            <classpath>
                <pathelement location="classes"/>
                <pathelement location="eclipse/ca.mcgill.sable.graph/graph.jar"/>
                <fileset dir="${eclipse.loc}/plugins/" includes="**/*.jar"/>
            </classpath>
        </javac>
        <jar destfile="eclipse/ca.mcgill.sable.soot/soot-plugin.jar">
            <fileset dir="eclipse/ca.mcgill.sable.soot/classes"/>
            <fileset dir="eclipse/ca.mcgill.sable.soot/src" includes="**/*.properties"/>
        </jar>
        <replaceregexp
            match="sootclasses-.*\.jar"
            replace="sootclasses-${soot.version}.jar"
        >
            <fileset dir="eclipse/ca.mcgill.sable.soot" includes="plugin.xml"/>
        </replaceregexp>
    </target>

    <!-- build the graph plugin-->
    <target name="graph-plugin">
        <javac
            destdir="eclipse/ca.mcgill.sable.graph/classes"
            debug="true"
        >
        <src path="eclipse/ca.mcgill.sable.graph/src"/>
        <classpath>
            <pathelement location="classes"/>
            <fileset dir="${eclipse.loc}/plugins/" includes="**/*.jar"/>
        </classpath>
        </javac>
        <jar destfile="eclipse/ca.mcgill.sable.graph/graph.jar">
            <fileset dir="eclipse/ca.mcgill.sable.graph/classes"/>
        </jar>
        
    </target>
		
	<target name="fulljar" depends="classesjar">
    	<mkdir dir="META-INF"/>

        <manifest file="META-INF/MANIFEST.MF">
           <attribute name="Main-Class" value="soot.Main"/>
           <attribute name="Implementation-Version" value="${soot.version}"/> 
        </manifest>
		
        <jar destfile="${release.loc}/soot-${soot.version}.jar" manifest="META-INF/MANIFEST.MF">
            <zipfileset src="${release.loc}/sootclasses-${soot.version}.jar"/>
            <zipfileset src="${jasmin.jar}"/>
            <zipfileset src="${heros.jar}"/>
            <zipfileset src="${polyglot.jar}"/>
            <zipfileset src="${javacup.jar}"/>
            <zipfileset src="${xmlprinter.jar}"/>
            <zipfileset src="${dexlib2.jar}"/>
            <zipfileset src="${dexlib-utils.jar}"/>
            <zipfileset src="${asm.jar}"/>
        </jar>
		<delete dir="META-INF"/>
    </target>
    
	<target name="sourcejar">
        <jar destfile="${release.loc}/sootsources-${soot.version}.jar">
            <fileset dir="src"/>
            <fileset dir="generated/singletons"/>
            <fileset dir="generated/sablecc"/>
            <fileset dir="generated/jastadd"/>
            <fileset dir="generated/options"/>
        </jar>
	</target>
    
</project>
